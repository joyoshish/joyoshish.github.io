document.addEventListener("DOMContentLoaded",(function(){function e(){l.style.display="block",setTimeout((()=>{a.focus()}),100),document.body.classList.add("search-active"),i()}function t(){window.innerWidth<=768?(l.style.paddingTop="0",l.style.paddingBottom="0",document.body.style.overflow="hidden",a.setAttribute("autocomplete","off"),a.setAttribute("autocorrect","off"),a.setAttribute("autocapitalize","off"),a.setAttribute("spellcheck","false")):(l.style.paddingTop="",l.style.paddingBottom="")}function n(){l.style.display="none",a.value="",u.innerHTML="",document.body.classList.remove("search-active"),document.body.style.overflow="",i()}function s(e){l.style.display&&"none"!==l.style.display&&(y=Array.from(u.querySelectorAll(".search-result-item")),0!==y.length&&("ArrowDown"===e.key?(e.preventDefault(),m=Math.min(m+1,y.length-1),o()):"ArrowUp"===e.key?(e.preventDefault(),m=Math.max(m-1,0),o()):"Enter"===e.key&&m>=0&&(e.preventDefault(),y[m].click())))}function o(){y.forEach((e=>{e.classList.remove("search-result-selected")})),m>=0&&m<y.length&&(y[m].classList.add("search-result-selected"),y[m].scrollIntoView({behavior:"smooth",block:"nearest"}))}function i(){m=-1,y=Array.from(u.querySelectorAll(".search-result-item")),y.forEach((e=>{e.classList.remove("search-result-selected")}))}function c(){fetch("/search_index.json").then((e=>e.json())).then((e=>{f=e,h=lunr((function(){this.field("title",{boost:10}),this.field("categories",{boost:5}),this.field("tags",{boost:5}),this.field("content"),this.ref("id"),e.forEach((function(e,t){this.add({id:t,title:e.title,categories:e.categories,tags:e.tags,content:e.content})}),this)}))})).catch((e=>console.error("Error loading search index:",e)))}const r=document.getElementById("search-button"),l=document.getElementById("search-modal"),a=document.getElementById("search-input"),d=document.getElementById("search-close"),u=document.getElementById("search-results").querySelector(".search-results-container");let h=[],f=[],m=-1,y=[];document.addEventListener("keydown",(function(o){(o.ctrlKey&&"k"===o.key||"/"===o.key&&!["INPUT","TEXTAREA"].includes(document.activeElement.tagName))&&(o.preventDefault(),e(),t()),"Escape"===o.key&&"block"===l.style.display&&n(),s(o)})),r.addEventListener("click",(function(){e(),t()})),d.addEventListener("click",n),window.addEventListener("click",(function(e){e.target===l&&n()})),window.addEventListener("resize",(function(){"block"===l.style.display&&t()})),a.addEventListener("input",(function(){const e=this.value.trim();if(i(),!e)return void(u.innerHTML="");if(0===h.length)return void(u.innerHTML='<div class="search-result-item">Loading search index...</div>');const t=h.search(e);0!==t.length?(u.innerHTML="",t.slice(0,10).forEach((e=>{const t=f[parseInt(e.ref)],n=document.createElement("a");n.href=t.url,n.classList.add("search-result-item");const s=document.createElement("div");s.classList.add("search-result-title"),s.textContent=t.title;const o=document.createElement("div");o.classList.add("search-result-preview"),o.textContent=t.content.substring(0,150)+"...",n.appendChild(s),n.appendChild(o),u.appendChild(n)}))):u.innerHTML='<div class="search-result-item">No results found</div>'})),c()}));